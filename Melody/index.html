<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>음계 측정기 2.1.2 (자유 채보)</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/vexflow@3.0.9/releases/vexflow-min.js"></script>
</head>

<body>
  <div class="container">
    <header>
      <h1>음계 측정기 2.1.2</h1>
      <p class="subtitle">실시간 음성 분석 · 자유 채보 · 메트로놈</p>
    </header>

    <main class="main-content">
      <section class="control-section">
        <button id="startBtn" class="primary-btn">
          <span class="btn-icon">🎤</span>
          시작하기
        </button>
      </section>

      <section class="analysis-panel">
        <div class="analysis-grid">
          <div class="analysis-item">
            <span class="label">음계</span>
            <span id="pitch" class="value">--</span>
          </div>
          <div class="analysis-item">
            <span class="label">음정</span>
            <span id="doremi" class="value">--</span>
          </div>
          <div class="analysis-item">
            <span class="label">옥타브</span>
            <span id="octave" class="value">--</span>
          </div>
          <div class="analysis-item">
            <span class="label">주파수</span>
            <span id="frequency" class="value">-- Hz</span>
          </div>
        </div>
      </section>

      <section class="metronome-section">
        <div class="section-header">
          <h2>메트로놈 설정</h2>
        </div>
        <div class="controls-grid">
          <div class="control-group">
            <label for="bpm">BPM <span id="bpmVal" class="accent">100</span></label>
            <input type="range" id="bpm" min="40" max="208" value="100" class="slider" />
          </div>
          <div class="control-group">
            <label for="metronomeVolume">볼륨 <span id="volVal" class="accent">50</span>%</label>
            <input type="range" id="metronomeVolume" min="0" max="100" value="50" class="slider" />
          </div>
        </div>
        <div class="controls-grid">
          <div class="control-group">
            <button id="toggleMetronome" class="secondary-btn">
              <span class="btn-icon">⏱️</span>
              메트로놈 켜기
            </button>
          </div>
          <div class="control-group">
            <button id="toggleFreeMode" class="secondary-btn">
              🎶 자유 채보: 켜짐
            </button>
          </div>
          <div class="control-group">
            <button id="clearFreeNotes" class="secondary-btn">
              🧹 자유 채보 지우기
            </button>
          </div>
        </div>
      </section>

      <section class="time-signature-section">
        <div class="section-header">
          <h2>박자 설정</h2>
        </div>
        <div class="time-signature-controls">
          <label>박자</label>
          <input type="number" min="1" max="16" id="numerator" value="4" />
          <span class="divider">/</span>
          <input type="number" min="1" max="32" id="denominator" value="4" />
        </div>
      </section>

      <section class="lyrics-section">
        <div class="section-header">
          <h2>가사 입력</h2>
        </div>
        <div class="controls-grid">
          <div class="control-group">
            <label for="lyricsInput">가사</label>
            <input id="lyricsInput" type="text" placeholder="예) 안녕하세요" />
          </div>
          <div class="control-group control-group-center">
            <label>정렬 단위</label>
            <div>
              <label>
                <input type="radio" name="lyrMode" value="syllable" checked />
                <span>음절</span>
              </label>
              <label style="margin-left:1rem;">
                <input type="radio" name="lyrMode" value="word" />
                <span>어절</span>
              </label>
            </div>
          </div>
          <div class="control-group">
            <button id="loadLyricsBtn" class="primary-btn">가사 로드</button>
          </div>
        </div>
      </section>

      <section class="score-section">
        <div class="section-header">
          <h2>실시간 악보</h2>
        </div>
        <div id="output" class="score-container"></div>
      </section>

      <section class="status-section">
        <div id="status" class="status-indicator">시작 버튼을 눌러 활성화</div>
      </section>
    </main>

    <footer>
      <a href="https://nodelinkweb.netlify.app/" target="_blank">
        @NodeLink
      </a>
    </footer>
  </div>

  <audio id="metronomeSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" preload="auto"></audio>
  <script src="script.js"></script>
</body>

</html>